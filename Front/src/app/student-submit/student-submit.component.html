<div class="page-container">
  <!-- Formes géométriques décoratives supplémentaires -->
  <div class="bg-shape-1"></div>
  <div class="bg-shape-2"></div>

  <div class="content-wrapper">
    <div class="container">
      <div class="form-card">
        <div class="card-header">
          <h2 style="color: white"><b>FICHE DE VALIDATION DE THEME</b></h2>
          <p style="color: white">
            <b
              >Remplissez tous les champs requis pour soumettre votre
              proposition de thème de mémoire</b
            >
          </p>

          <!-- Barre de progression -->
          <div class="progress-container" style="margin-top: 1rem">
            <div
              class="progress-bar"
              style="
                background: rgba(255, 255, 255, 0.2);
                height: 6px;
                border-radius: 3px;
              "
            >
              <div
                class="progress-fill"
                [style.width.%]="getCompletionPercentage()"
                style="
                  background: #4caf50;
                  height: 100%;
                  border-radius: 3px;
                  transition: width 0.3s ease;
                "
              ></div>
            </div>
            <small style="color: white; margin-top: 0.5rem; display: block">
              {{ getCompletionPercentage() }}% complété
            </small>
          </div>
        </div>

        <div class="card-content">
          <!-- IMPORTANT: Ajout de [formGroup] et (ngSubmit) -->
          <form
            class="proposal-form"
            [formGroup]="studentForm"
            (ngSubmit)="onSubmit()"
          >
            <!-- Contact -->
            <div class="form-group">
              <label for="contact" class="form-label">Contact *</label>
              <input
                id="contact"
                type="text"
                class="form-input"
                placeholder="Votre contact (téléphone, email, etc.)"
                formControlName="contact"
              />
              <div
                class="error-message"
                *ngIf="
                  studentForm.get('contact')?.invalid &&
                  studentForm.get('contact')?.touched
                "
              >
                Le contact est requis
              </div>
            </div>

            <!-- Nom et Prénoms -->
            <div class="form-group">
              <label for="fullName" class="form-label">Nom et Prénoms *</label>
              <input
                id="fullName"
                type="text"
                class="form-input"
                placeholder="Jean Dupont"
                formControlName="fullName"
              />
              <div
                class="error-message"
                *ngIf="
                  studentForm.get('fullName')?.invalid &&
                  studentForm.get('fullName')?.touched
                "
              >
                Le nom et prénoms sont requis
              </div>
            </div>
            <!-- Domaine -->
            <div class="form-group">
              <label for="domaine" class="form-label">Domaine *</label>
              <input
                id="domaine"
                type="text"
                class="form-input"
                placeholder="Informatique"
                formControlName="domaine"
              />
            </div>
            <!-- Libellé du thème -->
            <div class="form-group">
              <label for="themeTitle" class="form-label"
                >Libellé du thème *</label
              >
              <input
                id="themeTitle"
                type="text"
                class="form-input"
                placeholder="Titre de votre thème de mémoire"
                formControlName="themeTitle"
              />
              <div
                class="error-message"
                *ngIf="
                  studentForm.get('themeTitle')?.invalid &&
                  studentForm.get('themeTitle')?.touched
                "
              >
                Le libellé du thème est requis
              </div>
            </div>

            <!-- Problématique -->
            <div class="form-group">
              <label for="problematic" class="form-label"
                >Problématique *</label
              >
              <textarea
                id="problematic"
                class="form-textarea"
                placeholder="Décrivez la problématique que vous souhaitez aborder..."
                formControlName="problematic"
                rows="4"
              ></textarea>
              <div
                class="error-message"
                *ngIf="
                  studentForm.get('problematic')?.invalid &&
                  studentForm.get('problematic')?.touched
                "
              >
                La problématique est requise
              </div>
            </div>

            <!-- Objectif général -->
            <div class="form-group">
              <label for="generalObjective" class="form-label"
                >Objectif général *</label
              >
              <textarea
                id="generalObjective"
                class="form-textarea"
                placeholder="Décrivez l'objectif principal de votre recherche..."
                formControlName="generalObjective"
                rows="3"
              ></textarea>
              <div
                class="error-message"
                *ngIf="
                  studentForm.get('generalObjective')?.invalid &&
                  studentForm.get('generalObjective')?.touched
                "
              >
                L'objectif général est requis
              </div>
            </div>

            <!-- Objectifs spécifiques -->
            <div class="form-group">
              <label for="specificObjectives" class="form-label"
                >Objectifs spécifiques *</label
              >
              <textarea
                id="specificObjectives"
                class="form-textarea"
                placeholder="Listez vos objectifs spécifiques (un par ligne ou séparés par des points)..."
                formControlName="specificObjectives"
                rows="4"
              ></textarea>
              <div
                class="error-message"
                *ngIf="
                  studentForm.get('specificObjectives')?.invalid &&
                  studentForm.get('specificObjectives')?.touched
                "
              >
                Les objectifs spécifiques sont requis
              </div>
            </div>

            <!-- Résultats attendus -->
            <div class="form-group">
              <label for="expectedResults" class="form-label"
                >Les résultats attendus *</label
              >
              <textarea
                id="expectedResults"
                class="form-textarea"
                placeholder="Décrivez les résultats que vous espérez obtenir..."
                formControlName="expectedResults"
                rows="4"
              ></textarea>
              <div
                class="error-message"
                *ngIf="
                  studentForm.get('expectedResults')?.invalid &&
                  studentForm.get('expectedResults')?.touched
                "
              >
                Les résultats attendus sont requis
              </div>
            </div>

            <!-- Debug: Affichage du statut du formulaire -->
            <div class="debug-info" *ngIf="studentForm">
              <p><strong> Statut de remplissage du formulaire:</strong></p>
              <p>
                Formulaire valide: {{ studentForm.valid ? " OUI" : " NON" }}
              </p>
              <p>Pourcentage: {{ getCompletionPercentage() }}%</p>
              <p>Statut des champs:</p>
              <ul>
                <li>
                  Contact: {{ studentForm.get("contact")?.valid ? "" : "" }} ({{
                    studentForm.get("contact")?.value || "vide"
                  }})
                </li>
                <li>
                  Nom: {{ studentForm.get("fullName")?.valid ? "" : "" }} ({{
                    studentForm.get("fullName")?.value || "vide"
                  }})
                </li>
                <li>
                  Domaine: {{ studentForm.get("domaine")?.valid ? "" : "" }} ({{
                    studentForm.get("domaine")?.value || "vide"
                  }})
                </li>
                <li>
                  Thème:
                  {{ studentForm.get("themeTitle")?.valid ? "" : "" }} ({{
                    studentForm.get("themeTitle")?.value || "vide"
                  }})
                </li>
                <li>
                  Problématique:
                  {{ studentForm.get("problematic")?.valid ? "" : "" }} ({{
                    studentForm.get("problematic")?.value || "vide"
                  }})
                </li>
                <li>
                  Objectif général:
                  {{ studentForm.get("generalObjective")?.valid ? "" : "" }} ({{
                    studentForm.get("generalObjective")?.value || "vide"
                  }})
                </li>
                <li>
                  Objectifs spécifiques:
                  {{ studentForm.get("specificObjectives")?.valid ? "" : "" }}
                  ({{ studentForm.get("specificObjectives")?.value || "vide" }})
                </li>
                <li>
                  Résultats:
                  {{ studentForm.get("expectedResults")?.valid ? "" : "" }} ({{
                    studentForm.get("expectedResults")?.value || "vide"
                  }})
                </li>
              </ul>
            </div>

            <!-- Submit Buttons -->
            <div class="form-actions">
              <button type="button" class="cancel-button" (click)="onCancel()">
                Annuler
              </button>
              <button
                type="submit"
                class="submit-button"
                [disabled]="!isFormValid() || isSubmitting"
              >
                <svg
                  *ngIf="!isSubmitting"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="m22 2-7 20-4-9-9-4Z" />
                  <path d="M22 2 11 13" />
                </svg>
                <span *ngIf="isSubmitting">Envoi en cours...</span>
                <span *ngIf="!isSubmitting">Soumettre</span>
              </button>
            </div>
          </form>

          <!-- Affichage des données soumises -->
          <!-- <div class="values-display" *ngIf="showValues && submittedData">
        <h3>Données soumises :</h3>

        <div class="value-item">
          <strong>Contact :</strong> {{ submittedData.contact }}
        </div>
        <div class="value-item">
          <strong>Nom et Prénoms :</strong> {{ submittedData.fullName }}
        </div>
        <div class="value-item">
          <strong>Libellé du thème :</strong> {{ submittedData.themeTitle }}
        </div>
        <div class="value-item">
          <strong>Problématique :</strong>
          <p class="value-text">{{ submittedData.problematic }}</p>
        </div>
        <div class="value-item">
          <strong>Objectif général :</strong>
          <p class="value-text">{{ submittedData.generalObjective }}</p>
        </div>
        <div class="value-item">
          <strong>Objectifs spécifiques :</strong>
          <p class="value-text pre-line">
            {{ submittedData.specificObjectives }}
          </p>
        </div>
        <div class="value-item">
          <strong>Résultats attendus :</strong>
          <p class="value-text">{{ submittedData.expectedResults }}</p>
        </div>

        <div class="values-actions">
          <button type="button" (click)="hideValues()" class="btn-secondary">
            Masquer
          </button>
          <button type="button" (click)="resetForm()" class="btn-primary">
            Nouveau formulaire
          </button>
        </div>
      </div> -->
        </div>
      </div>
    </div>
  </div>
</div>
